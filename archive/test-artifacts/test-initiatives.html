<!DOCTYPE html>
<html>
<head>
    <title>Test Initiatives</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Testing Initiatives Fetch</h1>
    <div id="output"></div>

    <script>
        // Read your .env file values and paste them here
        const SUPABASE_URL = prompt('Enter your VITE_SUPABASE_URL:');
        const SUPABASE_ANON_KEY = prompt('Enter your VITE_SUPABASE_ANON_KEY:');

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        async function testFetch() {
            const output = document.getElementById('output');

            output.innerHTML = '<p>Fetching initiatives...</p>';

            try {
                const { data, error } = await supabase
                    .from('initiatives')
                    .select('id, initiative_name, status')
                    .order('initiative_name');

                if (error) {
                    output.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                    console.error('Error:', error);
                    return;
                }

                const activeCount = data.filter(i => i.status === 'Active' || i.status === 'Planning').length;

                output.innerHTML = `
                    <h2>Results:</h2>
                    <p><strong>Total initiatives:</strong> ${data.length}</p>
                    <p><strong>Active/Planning:</strong> ${activeCount}</p>
                    <h3>All Initiatives:</h3>
                    <ul>
                        ${data.slice(0, 20).map(i => `<li>${i.initiative_name} - ${i.status}</li>`).join('')}
                        ${data.length > 20 ? `<li>... and ${data.length - 20} more</li>` : ''}
                    </ul>
                    <pre>${JSON.stringify(data.slice(0, 3), null, 2)}</pre>
                `;
            } catch (err) {
                output.innerHTML = `<p style="color: red;">Exception: ${err.message}</p>`;
                console.error('Exception:', err);
            }
        }

        if (SUPABASE_URL && SUPABASE_ANON_KEY) {
            testFetch();
        }
    </script>
</body>
</html>
